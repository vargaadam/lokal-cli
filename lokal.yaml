version: lokal/v1alpha1
name: "test"
workspaces:
  - name: "ci"
    namespace: "ci"
    apps:
      - name: redis
      - name: service1
        alias: service-test1
        portForward: 3001
      - name: service2
        alias: service-test2
        portForward: 3002

apps:
  # redis
  - name: redis
    helm:
      name: redis-release
      repo: https://charts.bitnami.com/bitnami
      remoteChart: redis
      valuesFiles: []

  # service1
  - name: service1
    repository:
      localPath: "./service"
      repoPath: "git@github.com:vargaadam/example-service.git"
    manifests:
      deployment:
        enabled: true
        port: 3000
    build:
      image: test/image1
      context: service
      docker:
        dockerfile: Dockerfile
      sync:
        manual:
          - src: "src/**/*.js"
            dest: .

  # service2
  - name: service2
    repository:
      localPath: "./service2"
      repoPath: "git@github.com:vargaadam/example-service.git"
    manifests:
      deployment:
        enabled: true
        port: 3000
    build:
      image: test/image2
      context: service2
      docker:
        dockerfile: Dockerfile
      sync:
        manual:
          - src: "src/**/*.js"
            dest: .
